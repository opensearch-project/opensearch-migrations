apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: full-migration-
spec:
  workflowTemplateRef:
    name: full-migration
  entrypoint: main
  arguments:
    parameters:
      - name: sourceMigrationConfigs
        value: |
          [
              {
                  "source": {
                      "endpoint": "https://elasticsearch-master-headless:9200",
                      "allowInsecure": true,
                      "authConfig": {
                          "username": "admin",
                          "password": "admin"
                      }
                  },
                  "snapshotExtractAndLoadConfigs": [
                      {
                          "indices": [
                              "index_3",
                              "index_4"
                          ],
                          "snapshotConfig": {
                              "snapshotName": "indices_3_and_4",
                              "repoConfig": {
                                  "aws_region": "us-east-2",
                                  "endpoint": "http://localstack:4566",
                                  "repoPath": "snapshot"
                              }
                          },
                          "migrations": [
                              {
                                  "metadata": {
                                      "mappings": {
                                          "properties": {}
                                      },
                                      "settings": {}
                                  },
                                  "documentBackfillConfigs": [
                                      {
                                          "indices": [
                                              "index_3",
                                              "index_4"
                                          ]
                                      }
                                  ]
                              }
                          ]
                      }
                  ],
                  "replayerConfig": {
                      "batchSize": 1000,
                      "concurrency": 4
                  }
              }
          ]
      - name: targets
        value: |
          [
              {
                  "endpoint": "https://opensearch-cluster-master-headless:9200",
                  "allowInsecure": true,
                  "authConfig": {
                      "username": "admin",
                      "password": "admin"
                  }
              }
          ]
