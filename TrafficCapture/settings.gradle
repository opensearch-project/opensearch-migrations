/*
 * This file was generated by the Gradle 'init' task.
 *
 * The settings file is used to specify which projects to include in your build.
 *
 * Detailed information about configuring a multi-project build in Gradle can be found
 * in the user manual at https://docs.gradle.org/8.0.2/userguide/multi_project_builds.html
 */

plugins {
    id("com.gradle.enterprise") version("3.16.2")
}

void addSubProjects(String path, File dir) {
    if (dir.isDirectory() == false) return;
    if (dir.name == 'buildSrc') return;
    if (new File(dir, 'build.gradle').exists() == false) return;
    if (findProject(dir) != null) return;

    final String projectName = "${path}:${dir.name}"
    include projectName
    if (path.isEmpty() || path.startsWith(':example-plugins')) {
        project(projectName).projectDir = dir
    }
    for (File subdir : dir.listFiles()) {
        addSubProjects(projectName, subdir)
    }
}

rootProject.name = 'TrafficCapture'
include('captureKafkaOffloader',
        'captureOffloader',
        'captureProtobufs',
        'coreUtilities',
        'nettyWireLogging',
        'trafficCaptureProxyServer',
        'trafficReplayer',
        'testUtilities',
        'dockerSolution',
        'trafficCaptureProxyServerTest',
        'trafficCaptureDependencies'
)

addSubProjects('', new File(rootProject.projectDir,'replayerPlugins'))
addSubProjects('', new File(rootProject.projectDir,'trafficCaptureDependencies'))


if (System.getenv().containsKey("OS_MIGRATIONS_GRADLE_SCAN_TOS_AGREE_AND_ENABLED")) {
    gradleEnterprise {
        buildScan {
            publishAlways()
            termsOfServiceUrl = "https://gradle.com/terms-of-service"
            termsOfServiceAgree = "yes"
        }
    }
}
